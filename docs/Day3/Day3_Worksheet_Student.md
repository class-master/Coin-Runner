# Day3：スコアと難易度カーブ＆GameOverの日（7人×3時間用シナリオ）

## 0. 今日のゴール（先生が最初に読む用）

3時間で、次を「クラス全体」として完成させます。

1. 障害物を避けるごとに **スコアが加算** される（マイナスは無視）  
2. 時間の経過に応じて **難易度レベルが上がり、スピードが上昇** する  
3. HUDに **Score / Speed / Lv.** が表示される  
4. GameOver画面から **Retry/Exit が正しく動作** する（Retry時に初期化順序が正しい）

### 講師向けメモ（元ドキュメント要約）

# Day3 役割分担（7人×3h）— 体裁準拠
**DoD**
- スコア：回避で+10（可変）
- 難易度：`step_sec` 経過ごとに Lv++ と `speed` 上昇
- HUD：Score / Speed / Lv. 表示
- GameOver：Retry/Exit 遷移（Retry時の**初期化順**= Scoring→Difficulty→Scene）

## タイムテーブル
- 0:00–0:10  役割割当・API確認
- 0:10–0:25  設計読合せ（I/O/副作用/例外）
- 0:25–1:15  実装1
- 1:15–1:25  休憩
- 1:25–2:05  実装2（結合）
- 2:05–2:35  検証/修正
- 2:35–2:55  PR→レビュー→マージ
- 2:55–3:00  タグ `day3-2025-10-31`

## 7ロール
1 Scoring / 2 Difficulty / 3 HUD / 4 GameScene統合 / 5 GameOver / 6 Config / 7 QA


# Day3 チェックリスト
- [ ] 回避でスコアが増える（負値は無視）
- [ ] 経過時間で段階が上がる（境界で取りこぼし無し）
- [ ] HUDに Score / Speed / Lv. 表示
- [ ] GameOver → Retry/Exit が動作
- [ ] Day1/2の機能が壊れていない（回帰OK）


---

## 1. 今日の7人の役割（先に割り当てる）

| No | 役割名                            | 触るファイル              | ざっくりやること                                      |
|----|-----------------------------------|---------------------------|-------------------------------------------------------|
| A  | ScoringService組み込み担当       | `core/scoring.py` / `play.py` | 回避時にスコア加算・リセット処理                     |
| B  | DifficultyService組み込み担当    | `core/difficulty.py` / `play.py` | 経過時間でLvとSpeedを更新                            |
| C  | HUD連携担当                      | `ui/hud.py` / `play.py`   | Score/Speed/LvをHUDに流し込む                        |
| D  | GameOver遷移担当                 | `scenes/game_over_scene.py` / `play.py` | HP0→GameOver→Retry/Exit の流れ             |
| E  | 初期化順序チェック担当           | `play.py` / `core/*`      | Retry時のreset順序を確認・整理                       |
| F  | テスト（回帰）担当               | `tests/` / 手動プレイ     | Day1/2の挙動が壊れていないかチェック                |
| G  | バグログ＆ふりかえり担当         | `docs/Day3_buglog.md`     | バグ／改善点／感想を文章で残す                        |

---

## 2. 今日の時間割（板書用）

- 0:00〜0:10　Day2復習＆Day3のゴール共有
- 0:10〜0:25　API読み合わせ（Scoring/Difficulty/HUD）
- 0:25〜1:15　実装1（A〜Eが担当パートを進める）
- 1:15〜1:25　休憩
- 1:25〜2:05　実装2（結合＆GameOver遷移確認）
- 2:05〜2:35　回帰テスト（F主導）＆バグログ作成（G主導）
- 2:35〜3:00　まとめ＆Day4の方向性共有

---

## 3. 各役割の「やることチェックリスト」

### 3-1. A：ScoringService組み込み担当

- [ ] `core/scoring.py` を読み、どのメソッドを使えばいいかを確認した
- [ ] Playシーンに ScoringService インスタンスを持たせた
- [ ] 「障害物を避けた瞬間」に `add_for_avoid` を呼び出す位置を決めた
- [ ] GameOver時・Retry時に `reset` を呼ぶようにした

### 3-2. B：DifficultyService組み込み担当

- [ ] `core/difficulty.py` の `DifficultyService` を読み、`tick(dt)` の意味を理解した
- [ ] 毎フレームの更新時に `tick(dt)` を呼び、現在の `stage` / `speed` を取得した
- [ ] `P.BASE_SPEED` に対して、難易度の `speed` を掛け合わせる形で実装した

### 3-3. C：HUD連携担当

- [ ] `ui/hud.py` の `HUD.get_labels` が何を返すか確認した
- [ ] PlayシーンでHUDインスタンスを作成し、Score/Speed/Lvをテキストへ反映させた
- [ ] デバッグ用の追加表示と通常表示が混ざらないよう整理した

### 3-4. D：GameOver遷移担当

- [ ] 「HPが0になったとき」にGameOverへ遷移する処理を確認した
- [ ] `scenes/game_over_scene.py` の `GameOverScene.on_retry/on_exit` を読み、Navigatorを通して Title/Play へ戻る流れを理解した
- [ ] Retryでゲームに戻った時、前回のスコアや難易度が残っていないことを確認した

### 3-5. E：初期化順序チェック担当

- [ ] Retry時にどの順番で `reset` / 状態初期化 が行われているかを追いかけた
- [ ] 「Scoring → Difficulty → Scene内部の変数（t, speed, energyなど）」の順で初期化されているか確認した
- [ ] 問題があれば、コメントに「なぜこの順番なのか」を書いたうえで修正した

### 3-6. F：テスト（回帰）担当

- [ ] Day1とDay2で作った機能がすべて動いているか、チェックリストを自作した
- [ ] 特に「パララックス」「スポーン間隔」「F1デバッグ」が壊れていないか確認した
- [ ] 余裕があれば、`tests/` ディレクトリの中を読んで、pytestの存在だけ知っておく

### 3-7. G：バグログ＆ふりかえり担当（`docs/Day3_buglog.md`）

- [ ] 少なくとも3パターン以上の難易度（序盤／中盤／終盤）でプレイした
- [ ] 「気持ちよくスコアが伸びる瞬間」「理不尽に感じた瞬間」を具体的にメモした
- [ ] バグ・改善・感想を分けて記録した

---

## 4. 全員共通のNGリスト

- スコアや難易度の内部実装を、意味が分からないまま大きく書き換えない
- GameOver→Retryで状態が初期化されていないのに気付いたら、必ずチーム全員に共有する
- 「なんとなく動いているからOK」にせず、**なぜ動いているか** を口頭で説明してみる

---

## 5. 今日のまとめメモ欄（クラス用）

- 今日できたこと：

- 次にやりたいこと（Day4 への発展案など）：
