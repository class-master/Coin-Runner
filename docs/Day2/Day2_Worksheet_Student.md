# Day2：パララックスとフェアなスポーンの日（7人×3時間用シナリオ）

## 0. 今日のゴール（先生が最初に読む用）

3時間で、次を「クラス全体」として完成させます。

1. 背景が **3つの帯でパララックススクロール** する  
2. 障害物3種＋コインが、**理不尽になりすぎない間隔** で出現する  
3. F1キーなどで **デバッグ情報（時間／速度／next_x／last_kind）** を表示できる  

### 元のDay2タスク要約

# Day2 生徒用タスク（日本語ヒント）

## 目標
1) 背景3帯のパララックス
2) 障害3種＋コインのフェア・スポーン
3) F1デバッグ（t/speed/next_x/last）

## 手順
- `ui/parallax.py` のTODOを埋める（矩形2枚でラップ）
- `game/spawner.py` の `SpawnState` を完成（_choose_kind / next_item）
- `scenes/play.py` の D2 コメントに従って、背景tickと再配置処理を追加

## ヒント
- ラップ: 左に1枚分出たら x += 2*width
- 間隔: MIN_GAP + U(0, spread) ／ 高の直後は +EXTRA
- 連結: train_remaining を使って 'ob_train' を継続


### 絶対ルール

- 触るファイルは主に `ui/parallax.py`・`game/spawner.py`・`scenes/play.py`
- Day1で作った「走る／跳ぶ／避ける」の挙動は壊さない
- 迷ったら先生かこのプリントに必ず戻る

---

## 1. 今日の7人の役割（先に割り当てる）

| No | 役割名                          | 触るファイル          | ざっくりやること                                         |
|----|---------------------------------|-----------------------|----------------------------------------------------------|
| A  | Parallaxレイヤ担当             | `ui/parallax.py`      | 背景3帯の矩形2枚スクロール処理を完成させる              |
| B  | SpawnStateロジック担当        | `game/spawner.py`     | `SpawnState` クラスの `_choose_kind` / `next_item` 実装 |
| C  | Playシーンへの組み込み担当     | `scenes/play.py`      | ParallaxとSpawnStateをPlayシーンに組み込む              |
| D  | コイン／障害物のバランス担当   | `config.py` / `spawner.py` | MIN_GAP/SPREAD/EXTRA/COIN_RATE などの調整         |
| E  | F1デバッグ表示担当             | `scenes/play.py`      | F1でデバッグ表示 ON/OFF（時間／速度／next_x／last_kind）|
| F  | HUDテキスト調整担当           | `ui/hud.py` / `play.py`| Score/SpeedなどのHUD内容をDay2仕様に合わせる           |
| G  | テスト＆バグログ担当           | `docs/Day2_buglog.md` | テストプレイとバグ／改善アイデアの記録                  |

---

## 2. 今日の時間割（板書用）

- 0:00〜0:10　Day1の復習＆Day2のゴール共有
- 0:10〜0:20　役割分担とAPIの読み合わせ
- 0:20〜1:10　実装1（A〜Fが担当パートを進める）
- 1:10〜1:25　休憩
- 1:25〜2:05　実装2（結合＆調整）
- 2:05〜2:35　テストプレイ＆デバッグ
- 2:35〜3:00　バグログ整理＆Day3予告

---

## 3. 各役割の「やることチェックリスト」

### 3-1. A：Parallaxレイヤ担当（`ui/parallax.py`）

- [ ] `__init__` 内のTODOコメントをすべて読んだ
- [ ] canvasに `Color` と `Rectangle` を2枚作り、`bind` で `_sync` を呼ぶようにした
- [ ] `_sync` で、自分の `size` / `pos` に合わせて矩形2枚を横並びに配置した
- [ ] `tick` で左方向へスクロールし、`x <= -width` になったら `+2*width` でワープさせた

### 3-2. B：SpawnStateロジック担当（`game/spawner.py`）

- [ ] `SpawnState.__init__` のコメントを読む
- [ ] `train_remaining`・`last_kind` の意味を理解した
- [ ] `_choose_kind` が「列車（train）」を継続させるロジックになっているか確認した
- [ ] `next_item` で gap計算→`next_x`更新→種類選択→y/size決定→dict返却 の流れを実装した

### 3-3. C：Playシーンへの組み込み担当（`scenes/play.py`）

- [ ] ParallaxLayerを3つ作成し、それぞれ違う速度で `tick` を呼ぶようにした
- [ ] `SpawnState` を1つ作成し、「画面外に出たObjを再利用する」箇所で `next_item` を使うようにした
- [ ] kindによって色・サイズ・高さを切り替える処理を実装した（`ob_low` / `ob_high` / `ob_train` / `coin`）

### 3-4. D：コイン／障害物のバランス担当

- [ ] `P.COIN_RATE` や gap関連パラメータの意味を確認した
- [ ] 「理不尽に詰まない」「スカスカすぎない」バランスを目指して値を調整した
- [ ] テストプレイの感想をGと共有し、採用する値を決めた

### 3-5. E：F1デバッグ表示担当

- [ ] キー入力の処理で、F1キー押下を検出する実装位置を決めた
- [ ] ON/OFFフラグを用意し、ONのときだけデバッグ情報をHUDに足すようにした
- [ ] 表示項目：経過時間t／現在speed／next_x／last_kind など

### 3-6. F：HUDテキスト調整担当

- [ ] Day1時点のHUD表示を見直し、「Score」「Energy」「Speed」「Lv」など必要な情報を整理した
- [ ] 必要であれば `ui/hud.py` の`HUD`クラスを使って、Playシーンから呼び出す形に整えた
- [ ] デバッグテキストと通常テキストが混ざって読みにくくならないように工夫した

### 3-7. G：テスト＆バグログ担当（`docs/Day2_buglog.md`）

- [ ] 少なくとも5回以上プレイした
- [ ] 「理不尽に感じた場面」「気持ちよく避けられた場面」を具体的に記録した
- [ ] バグや改善案を1件ずつタイトル付きで残した

---

## 4. 全員共通のNGリスト

- Day1で完成していた挙動（ジャンプ／スコア加算／エネルギー減少）を壊したら必ず気付くこと
- パラメータ調整で「何を変えたのか」を残さずに上書きしない
- Gitを使う場合、意味のある単位でコミットする

---

## 5. 今日のまとめメモ欄（クラス用）

- 今日できたこと：

- 次にやりたいこと（Day3 への発展案など）：
